2024-10-16 21:49:33,646 IRRA INFO: Using 1 GPUs
2024-10-16 21:49:33,646 IRRA INFO: Namespace(MLM=False
 alpha=0.9
 batch_size=128
 beta=0.999
 bias_lr_factor=2.0
 cmt_depth=4
 dataset_name='CUHK-PEDES'
 depth=12
 distributed=False
 eval_period=1
 gamma=0.1
 id_loss_weight=1.0
 img_aug=True
 img_size=(384
 128)
 local_rank=0
 log_period=100
 loss_names='sdm'
 lr=0.0003
 lr_factor=5.0
 lrscheduler='cosine'
 masked_token_rate=0.8
 masked_token_unchanged_rate=0.1
 milestones=(20
 50)
 mlm_loss_weight=1.0
 momentum=0.9
 n_ctx=4
 name='baseline'
 num_epoch=60
 num_instance=4
 num_workers=8
 optimizer='Adam'
 output_dir='logs/CUHK-PEDES/20241016_214933_baseline'
 power=0.9
 pretrain_choice='ViT-B/16'
 resume=False
 resume_ckpt_file=''
 root_dir='/data/lyw/dataset_reid'
 sampler='random'
 stride_size=16
 target_lr=0
 temperature=0.02
 test_batch_size=512
 text_length=77
 training=True
 val_dataset='test'
 vocab_size=49408
 warmup_epochs=5
 warmup_factor=0.1
 warmup_method='linear'
 weight_decay=4e-05
 weight_decay_bias=0.0)
2024-10-16 21:49:34,461 IRRA.dataset INFO: => CUHK-PEDES Images and Captions are loaded
2024-10-16 21:49:34,461 IRRA.dataset INFO: CUHKPEDES Dataset statistics:
2024-10-16 21:49:34,462 IRRA.dataset INFO: 
+--------+-------+--------+----------+
| subset |  ids  | images | captions |
+--------+-------+--------+----------+
| train  | 11003 | 34054  |  68126   |
|  test  |  1000 |  3074  |   6156   |
|  val   |  1000 |  3078  |   6158   |
+--------+-------+--------+----------+
2024-10-16 21:49:34,567 IRRA.dataset INFO: using random sampler
2024-10-16 21:49:35,951 IRRA.model INFO: Load pretrained ViT-B/16 CLIP model with model config: {'embed_dim': 512, 'image_resolution': (384, 128), 'vision_layers': 12, 'vision_width': 768, 'vision_patch_size': 16, 'context_length': 77, 'vocab_size': 49408, 'transformer_width': 512, 'transformer_heads': 8, 'transformer_layers': 12, 'n_ctx': 4, 'stride_size': 16}
2024-10-16 21:49:40,536 IRRA INFO: Total params: 162M
2024-10-16 21:49:52,628 IRRA.eval INFO: 
+------+-------+-------+-------+-------+-------+
| task |   R1  |   R5  |  R10  |  mAP  |  mINP |
+------+-------+-------+-------+-------+-------+
| t2i  | 0.146 | 0.552 | 1.186 | 0.412 | 0.214 |
+------+-------+-------+-------+-------+-------+
2024-10-16 21:49:52,628 IRRA INFO: test done. Time: 9.635[s]
2024-10-16 21:49:52,628 IRRA.train INFO: start training
